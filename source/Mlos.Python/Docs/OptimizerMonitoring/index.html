<!DOCTYPE html>
<html lang="en" dir=>

<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Optimizer Monitoring Motivation The goal of this document is to outline the process of monitoring the optimizers, enumerate the metrics we wish to collect and the tools required to do so.
What we wish to monitor For each optimizer we should be able to:
 View it&rsquo;s current configuration (done). View all the data that it was trained on. View the state of the surrogate models:  Have they been fitted?">
<meta name="theme-color" content="#FFFFFF"><meta property="og:title" content="" />
<meta property="og:description" content="Optimizer Monitoring Motivation The goal of this document is to outline the process of monitoring the optimizers, enumerate the metrics we wish to collect and the tools required to do so.
What we wish to monitor For each optimizer we should be able to:
 View it&rsquo;s current configuration (done). View all the data that it was trained on. View the state of the surrogate models:  Have they been fitted?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://microsoft.github.io/MLOS/source/Mlos.Python/Docs/OptimizerMonitoring/" />

<title>Optimizer Monitoring | MLOS</title>
<link rel="manifest" href="/MLOS/manifest.json">
<link rel="icon" href="/MLOS/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/MLOS/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css" integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY=">
<script defer src="/MLOS/en.search.min.fe6aeb1f41a735518e7627ce9c5948ab931329344f72364de3fae05cb79e220e.js" integrity="sha256-/mrrH0GnNVGOdifOnFlIq5MTKTRPcjZN4/rgXLeeIg4="></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

  
</head>

<body dir=>
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      
  <nav>
<h2 class="book-brand">
  <a href="/MLOS"><span>MLOS</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>











  <ul>
<li>
<p><a href="/MLOS/documentation/">Documentation</a></p>
<ul>
<li><a href="/MLOS/documentation/01-Prerequisites/">Prerequisites</a></li>
<li><a href="/MLOS/documentation/02-Build/">Build</a></li>
<li><a href="/MLOS/documentation/04-Test/">Test</a></li>
<li><a href="/MLOS/documentation/CodingStandard/">Coding Standard</a></li>
<li><a href="/MLOS/documentation/MlosArchitecture/">Architecture</a></li>
<li><a href="/MLOS/documentation/RepoOrganization/">Repo Organization</a></li>
</ul>
</li>
<li>
<p><a href="/MLOS/notebooks/">Notebooks</a></p>
<ul>
<li><a href="/MLOS/notebooks/BayesianOptimization/">Bayesian Optimization</a></li>
<li><a href="/MLOS/notebooks/SmartCacheOptimization/">Smart Cache Optimization</a></li>
<li><a href="/MLOS/notebooks/SmartCacheCPP/">Smart Cache Optimization in C++</a></li>
<li><a href="/MLOS/notebooks/LevelDbTuning/">LevelDB External Tuning Example</a></li>
</ul>
</li>
<li>
<p><a href="/MLOS/source/Examples/">E2E Examples</a></p>
<ul>
<li><a href="/MLOS/source/Examples/SmartCache/">Smart Cache</a></li>
</ul>
</li>
<li>
<p>API Documentation</p>
<ul>
<li><a href="/MLOS/python_api/">Python</a></li>
</ul>
</li>
<li>
<p>Component Documentation</p>
<ul>
<li><a href="/MLOS/source/Mlos.SettingsSystem.CodeGen/">Mlos Settings System Code Generation System</a></li>
<li><a href="/MLOS/source/Mlos.Core/doc/">Mlos.Core Shared Memory Communication Channel</a></li>
<li><a href="/MLOS/source/Mlos.Agent.Server/">Mlos.Agent.Server</a></li>
</ul>
</li>
<li>
<p><a href="/MLOS/external/">External Integration</a></p>
</li>
<li>
<p><a href="/MLOS/CODE_OF_CONDUCT/">Code of Conduct</a></p>
</li>
<li>
<p><a href="/MLOS/CONTRIBUTING/">Contributing</a></p>
</li>
<li>
<p><a href="https://github.com/Microsoft/MLOS">MLOS Github Repository</a></p>
</li>
</ul>










</nav>




  <script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script>


 
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/MLOS/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Optimizer Monitoring</strong>

  <label for="toc-control">
    
    <img src="/MLOS/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  <nav id="TableOfContents">
  <ul>
    <li><a href="#motivation">Motivation</a></li>
    <li><a href="#what-we-wish-to-monitor">What we wish to monitor</a></li>
    <li><a href="#representing-the-state">Representing the state</a>
      <ul>
        <li><a href="#serializing-the-state">Serializing the state</a></li>
      </ul>
    </li>
  </ul>
</nav>


  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="optimizer-monitoring">Optimizer Monitoring</h1>
<h2 id="motivation">Motivation</h2>
<p>The goal of this document is to outline the process of monitoring the optimizers, enumerate the metrics we wish to collect and the tools required to do so.</p>
<h2 id="what-we-wish-to-monitor">What we wish to monitor</h2>
<p>For each optimizer we should be able to:</p>
<ol>
<li>View it&rsquo;s current configuration (done).</li>
<li>View all the data that it was trained on.</li>
<li>View the state of the surrogate models:
<ol>
<li>Have they been fitted?</li>
<li>How many times has it been refitted?</li>
<li>In case of an ensemble: has each of the component models been fitted?</li>
<li>What are the values of goodness of fit measures?</li>
<li>How many samples did the model consume?</li>
<li>What exact data was each model trained on?</li>
<li>Which of the objectives is the model predicting?</li>
<li>Data specific to each model class. For example for a Decision Tree:
<ol>
<li>Number of leafs</li>
<li>Leaf statistics (sample mean, sample var, count)</li>
<li>Depth and shape</li>
<li>Splits</li>
</ol>
</li>
</ol>
</li>
</ol>
<p>It makes sense for all of that information (except for the exact data) to be maintained by the model, and presented upon request. Storing multiple copies of data seems to be heavy overhead, so we should avoid it if at all possible. This problem will be solved by the introduction of DataSets and DataSetViews.</p>
<h2 id="representing-the-state">Representing the state</h2>
<p>It might be tempting to create a dictionary to store all of this data. I think such hash-map-oriented programming paradigm will quickly deteriorate, especially as more and more people begin contributing.</p>
<p>So a better approach would be to have a base class that stores (in common format) information common to all model classes. For each model we could derive a specialized class, that stores the more specific information.</p>
<h3 id="serializing-the-state">Serializing the state</h3>
<p>We will have to be able to send this data over gRPC, so we must be mindful of how to serialize/deserialize it. Options include:</p>
<ul>
<li>Defining this struct in a .proto file and populating it directly.</li>
<li>Serializing the struct to json.</li>
<li>Serializing the struct using pickle.</li>
</ul>
<p>The problem with .proto approach is that this becomes part of the API and will make changing anything unnecessarily hard.</p>
<p>The problem with json is that writing json serializer is extra work.</p>
<p>The problem with pickle is that only Python can deserialize it. But since we only need to deserialize in Python for the foreseeable future, we will go with this option. However, to hedge our bets, I&rsquo;ll wrap the calls to pickle.dumps and pickle.loads inside a .serialize(), .deserialize() functions to allow for an implementation change down the road (e.g. if we want to monitor the optimizer from C# or Julia).</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>

 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      
  <nav id="TableOfContents">
  <ul>
    <li><a href="#motivation">Motivation</a></li>
    <li><a href="#what-we-wish-to-monitor">What we wish to monitor</a></li>
    <li><a href="#representing-the-state">Representing the state</a>
      <ul>
        <li><a href="#serializing-the-state">Serializing the state</a></li>
      </ul>
    </li>
  </ul>
</nav>

 
    </aside>
    
  </main>

  
</body>

</html>












